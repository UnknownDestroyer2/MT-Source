#!/usr/bin/env python3
# vulnerability_scanner.py 

import argparse
import subprocess
import requests

def run_nikto(target):
    print(f"[+] Nikto scan: {target}")
    try:
        subprocess.run(["nikto", "-h", target], check=True)
    except Exception as e:
        print(f"[!] Nikto failed to start: {e}")

def run_nuclei(target, templates):
    print(f"[+] Nuclei scan: {target} (templates: {templates})")
    try:
        subprocess.run(["nuclei", "-u", target, "-t", templates], check=True)
    except Exception as e:
        print(f"[!] Nuclei failed: {e}")

def check_trace(target):
    print(f"[+] HTTP TRACE method: {target}")
    try:
        r = requests.request("TRACE", target, timeout=5, verify=False)
        if r.status_code == 200:
            print("[!] TRACE on, XST vuln possible!")
        else:
            print("[-] TRACE off, clean.")
    except Exception as e:
        print(f"[!] TRACE scan failed: {e}")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Basit Vulnerability Scanner â€“ Hacker Tool")
    parser.add_argument("url", help="Target URL (http://domain.com)")
    parser.add_argument("-t", "--templates", default="~/.nuclei-templates", help="Nuclei template dir")
    args = parser.parse_args()

    target = args.url
    templates = args.templates

    run_nikto(target)
    run_nuclei(target, templates)
    check_trace(target)
